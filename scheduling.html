<!DOCTYPE html>
<html class="full" lang="en">
<head>
  <title>Google Calendar API</title>
  <script>
    // Google api console clientID and apiKey 

    var clientId = '628609468275-nrfc15op8bd8lvao8beovf2iga43co4i.apps.googleusercontent.com';
    var apiKey = 'AIzaSyAd00WhxEpwxJwDIxFaxKxJqyY1moPeT9g';

   // enter the scope of current project (this API must be turned on in the Google console)
   var scopes = 'https://www.googleapis.com/auth/calendar';

   console.log("SOMETHING HAPPENDE???")
  // OAuth2 functions
  function handleClientLoad() {
  	console.log("Inside handleClientLoad ...");
  	gapi.client.setApiKey(apiKey);
  	window.setTimeout(checkAuth, 100);
  }

  //To authenticate
  function checkAuth() {
    console.log("Inside checkAuth ...");
  	gapi.auth.authorize({ client_id: clientId, scope: scopes, immediate: true }, handleAuthResult);

  }

  /* Invoked by different functions to handle the result of authentication checks.*/
  function handleAuthResult(authResult) {

      console.log("Inside handleAuthResult ...");
      var authorizeButton = document.getElementById('authorize-button');
      var addButton = document.getElementById('addToCalendar');
      if (authResult && !authResult.error) {
            authorizeButton.style.visibility = 'hidden';
            addButton.style.visibility = 'visible'; 
            //load the calendar client library
            gapi.client.load('calendar', 'v3', function(){ 
              console.log("Calendar library loaded.");
            });
      } else {
            authorizeButton.style.visibility = '';
            authorizeButton.onclick = handleAuthClick;
          }
  }

  /* Event handler that deals with clicking on the Authorize button.*/
  function handleAuthClick(event) {
    console.log("in aurth click!");
      gapi.auth.authorize({client_id: clientId, scope: scopes, immediate: false}, 
                          handleAuthResult);
      return false;
  }

var add_minutes =  function (dt, minutes) {  
    return new Date(dt.getTime() + minutes*60000);  
}


  function createEvente() {
    var today = new Date();
    var later = add_minutes(today,30);



  // First create resource that will be send to server.
    var resource = {
        "summary": "---",
        "start": {
          //"dateTime": new Date(d.getDate() + " " + d.getTime().toISOString()
          "dateTime": today.toISOString()
        },
        "end": {
          //"dateTime": new Date(eventData.date + " " + eventData.endTime).toISOString()
          "dateTime": later.toISOString()
          }
        };
    // create the request
    var request = gapi.client.calendar.events.insert({
      'calendarId': '0ouj56vsdv2h2bu9ree86op3kc@group.calendar.google.com',
      'resource': resource
    });

    // execute the request and do something with response
    request.execute(function(resp) {
      console.log(resp);
      alert("Your event was added to the calendar.");
    });
  }

  </script>

  <script src="https://apis.google.com/js/client.js?onload=handleClientLoad"></script>
</head>

<body>
<button id="btnCreateEvents" class="btn btn-primary" onclick="createEvente();">
	Create Events</button>  
		<iframe src="https://calendar.google.com/calendar/embed?showTitle=0&amp;showDate=0&amp;showPrint=0&amp;showTabs=0&amp;showCalendars=0&amp;mode=WEEK&amp;height=600&amp;wkst=1&amp;bgcolor=%23FFFFFF&amp;src=0ouj56vsdv2h2bu9ree86op3kc%40group.calendar.google.com&amp;color=%23691426&amp;ctz=America%2FNew_York" style="border-width:0" width="800" height="600" frameborder="0" scrolling="no"></iframe>
	<button id="authorize-button" style="visibility: hidden">Login &amp; Authorize</button>
  <button id="addToCalendar" style="visibility: visible;">Add to Google Calendar</button>
</body>